        -:    0:Source:print_tokens_instrumented.c
        -:    0:Graph:print_tokens_instrumented.gcno
        -:    0:Data:print_tokens_instrumented.gcda
        -:    0:Runs:4130
        -:    1:
        -:    2:
        -:    3:# include <ctype.h>
        -:    4:
        -:    5:# define START  5
        -:    6:# define TRUE  1
        -:    7:# define FALSE 0
        -:    8:
        -:    9:typedef int BOOLEAN;
        -:   10:typedef char *string;
        -:   11:
        -:   12:# include <stdio.h>
        -:   13:# include "tokens.h"
        -:   14:
        -:   15:static token numeric_case();
        -:   16:static token error_or_eof_case();
        -:   17:static int check_delimiter();
        -:   18:static int keyword(int state);
        -:   19:static int special(int state);
        -:   20:static skip(character_stream stream_ptr);
        -:   21:static int constant(int state,char token_str[],int token_ind);
        -:   22:static int next_state();
        -:   23:static get_actual_token(char token_str[],int token_ind);
        -:   24:
        -:   25:FILE* file_name = NULL;
        -:   26:
        -:   27:
     4130:   28:main(argc,argv)
        -:   29:int argc;
        -:   30:char *argv[];
        -:   31:{   
     4130:   32:    file_name=fopen("v6.txt","a+"); 
     4130:   33:    if(!file_name)
        -:   34:    {	
    #####:   35:        printf("File could not be opened! \n");
    #####:   36:        fclose(file_name);
    #####:   37:        exit(0);
        -:   38:    }
        -:   39:	
        -:   40:    token token_ptr;
        -:   41:    token_stream stream_ptr;
     4130:   42:    fprintf(file_name,"\nP1,");
     4130:   43:    if(argc>2)
        -:   44:    {
       30:   45:        fprintf(file_name,"P2,");
       30:   46:        fprintf(stdout, "The format is print_tokens filename(optional)\n");
       30:   47:        fclose(file_name);
       30:   48:        exit(1);
        -:   49:    }
        -:   50:    
     4100:   51:    stream_ptr=open_token_stream(argv[1]);
     4070:   52:    fprintf(file_name,"P3,");
    34603:   53:    while(!is_eof_token((token_ptr=get_token(stream_ptr))))
        -:   54:    {
    30533:   55:        fprintf(file_name,"P4,");
    30533:   56:        print_token(token_ptr);
        -:   57:    }
        -:   58:            
     4070:   59:    fprintf(file_name,"P5,");
     4070:   60:    print_token(token_ptr);
     4070:   61:    fclose(file_name);
     4070:   62:    exit(0);
        -:   63:}
        -:   64:
     4100:   65:character_stream open_character_stream(FILENAME)
        -:   66:string FILENAME;
        -:   67:{
        -:   68:    character_stream stream_ptr;
     4100:   69:    stream_ptr=(character_stream)malloc(sizeof(struct stream_type));
     4100:   70:    stream_ptr->stream_ind=START;
     4100:   71:    stream_ptr->stream[START]='\0';
     4100:   72:    fprintf(file_name,"P6,");
     4100:   73:    if(FILENAME == NULL)
        -:   74:    {
     2963:   75:        fprintf(file_name,"P7,");
     2963:   76:        stream_ptr->fp=stdin;
        -:   77:    }
     1137:   78:    else if((stream_ptr->fp=fopen(FILENAME,"r"))==NULL)
        -:   79:    {
       30:   80:        fprintf(file_name,"P8,");
       30:   81:        fprintf(stdout, "The file %s doesn't exists\n",FILENAME);
       30:   82:        fclose(file_name);
       30:   83:        exit(0);
        -:   84:    }
     4070:   85:    fprintf(file_name,"P9,");
     4070:   86:    return(stream_ptr);
        -:   87:}
        -:   88:
   176003:   89:CHARACTER get_char(stream_ptr)
        -:   90:character_stream stream_ptr;
        -:   91:{
   176003:   92:    fprintf(file_name,"P10,");
   176003:   93:    if(stream_ptr->stream[stream_ptr->stream_ind] == '\0')
        -:   94:    {
    12791:   95:        fprintf(file_name,"P11,");
    12791:   96:        if(fgets(stream_ptr->stream+START,80-START,stream_ptr->fp) == NULL)/* Fix bug: add -START - hf*/
        -:   97:        {
     4070:   98:            fprintf(file_name,"P12,");
     4070:   99:            stream_ptr->stream[START]=EOF;
        -:  100:        }
    12791:  101:        fprintf(file_name,"P13,");
    12791:  102:        stream_ptr->stream_ind=START;
        -:  103:    }
   176003:  104:    fprintf(file_name,"P14,");
   176003:  105:    return(stream_ptr->stream[(stream_ptr->stream_ind)++]);
        -:  106:}
        -:  107:
    30136:  108:BOOLEAN is_end_of_character_stream(stream_ptr)
        -:  109:character_stream stream_ptr;
        -:  110:{
    30136:  111:    fprintf(file_name,"P15,");
    30136:  112:    if(stream_ptr->stream[stream_ptr->stream_ind-1] == EOF)
        -:  113:	{
     4112:  114:        fprintf(file_name,"P16,");
     4112:  115:        return(TRUE);
        -:  116:    } 
        -:  117:    else
        -:  118:    {
    26024:  119:        fprintf(file_name,"P17,");
    26024:  120:        return(FALSE);
        -:  121:    }
        -:  122:        
        -:  123:}
        -:  124:
    15031:  125:unget_char(ch,stream_ptr)
        -:  126:CHARACTER ch;
        -:  127:character_stream stream_ptr;
        -:  128:{
    15031:  129:    fprintf(file_name,"P18,");
    15031:  130:    if(stream_ptr->stream_ind == 0)
        -:  131:	{
    #####:  132:        fprintf(file_name,"P19,");
    #####:  133:        return;
        -:  134:    }
        -:  135:    else
        -:  136:	{
    15031:  137:        fprintf(file_name,"P20,");
    15031:  138:        stream_ptr->stream[--(stream_ptr->stream_ind)]=ch;
        -:  139:    }
    15031:  140:    fprintf(file_name,"P21,");  
    15031:  141:    return;
        -:  142:}
        -:  143:
     4100:  144:token_stream open_token_stream(FILENAME)
        -:  145:string FILENAME;
        -:  146:{
     4100:  147:    fprintf(file_name,"P22,");  
        -:  148:    token_stream token_ptr;
     4100:  149:    token_ptr=(token_stream)malloc(sizeof(struct token_stream_type));
     4100:  150:    token_ptr->ch_stream=open_character_stream(FILENAME);
     4070:  151:    return(token_ptr);
        -:  152:}
        -:  153:
    34603:  154:token get_token(tstream_ptr)
        -:  155:token_stream tstream_ptr;
        -:  156:{
        -:  157:    char token_str[80]; /* This buffer stores the current token */
        -:  158:    int token_ind;      /* Index to the token_str  */
        -:  159:    token token_ptr;
        -:  160:    CHARACTER ch;
        -:  161:    int cu_state,next_st,token_found;
    34603:  162:    token_ptr=(token)(malloc(sizeof(struct token_type)));
    34603:  163:    ch=get_char(tstream_ptr->ch_stream);
    34603:  164:    cu_state=token_ind=token_found=0;
    34603:  165:    fprintf(file_name,"P23,");  
   151954:  166:    while(!token_found)
        -:  167:    {
   151954:  168:        fprintf(file_name,"P24,");
   151954:  169:        if(token_ind < 80) /* ADDED ERROR CHECK - hf */
        -:  170:        {
   151917:  171:            fprintf(file_name,"P25,");
   151917:  172:            token_str[token_ind++]=ch;
   151917:  173:            next_st=next_state(cu_state,ch);
        -:  174:        }
        -:  175:        else
        -:  176:        {
       37:  177:            fprintf(file_name,"P26,");
       37:  178:            next_st = -1; /* - hf */
        -:  179:        }
   151954:  180:        if (next_st == -1) 
        -:  181:        {
    12173:  182:            fprintf(file_name,"P27,");
    34603:  183:            return(error_or_eof_case(tstream_ptr, token_ptr,cu_state,token_str,token_ind,ch));
        -:  184:        } 
   139781:  185:        else if (next_st == -2) 
        -:  186:        {
     2621:  187:            fprintf(file_name,"P28,");
     2621:  188:            return(numeric_case(tstream_ptr,token_ptr,ch, token_str,token_ind));
        -:  189:        } 
   137160:  190:        else if (next_st == -3) 
        -:  191:        {
     8942:  192:            fprintf(file_name,"P29,");
     8942:  193:            token_ptr->token_id=IDENTIFIER;
     8942:  194:            unget_char(ch,tstream_ptr->ch_stream);
     8942:  195:            token_ind--;
     8942:  196:            get_actual_token(token_str,token_ind);
     8942:  197:            strcpy(token_ptr->token_string,token_str);
     8942:  198:            return(token_ptr);
        -:  199:        } 
        -:  200:
   128218:  201:        fprintf(file_name,"P30,");  
   128218:  202:        switch(next_st) 
        -:  203:        { 
   115404:  204:            default : 
   115404:  205:                fprintf(file_name,"P31,"); 
   115404:  206:                break;
     2210:  207:            case 6  : /* These are all KEYWORD cases. */
        -:  208:            case 9  :
        -:  209:            case 11 :
        -:  210:            case 13 :
        -:  211:            
        -:  212:			case 16 :
     2210:  213:                ch=get_char(tstream_ptr->ch_stream);
     2210:  214:                fprintf(file_name,"P32,");
     2210:  215:                if(check_delimiter(ch)==TRUE)
        -:  216:                {
     2166:  217:                    fprintf(file_name,"P33,");
     2166:  218:                    token_ptr->token_id=keyword(next_st);
     2166:  219:                    unget_char(ch,tstream_ptr->ch_stream);
     2166:  220:                    token_ptr->token_string[0]='\0';
     2166:  221:                    return(token_ptr);
        -:  222:                }
       44:  223:                fprintf(file_name,"P34,");
       44:  224:                unget_char(ch,tstream_ptr->ch_stream);
       44:  225:                break;
     5217:  226:            case 19 : /* These are all special SPECIAL character */
        -:  227:            case 20 : /* cases */
        -:  228:            case 21 :
        -:  229:            case 22 :
        -:  230:            case 23 :
        -:  231:            case 24 :
        -:  232:            case 25 :
        -:  233:            case 32 : 
     5217:  234:                fprintf(file_name,"P35,");
     5217:  235:                token_ptr->token_id=special(next_st);
     5217:  236:                token_ptr->token_string[0]='\0';
     5217:  237:                return(token_ptr);
     3484:  238:            case 27 : /* These are constant cases */
        -:  239:            case 29 :
     3484:  240:                fprintf(file_name,"P36,");
     3484:  241:                token_ptr->token_id=constant(next_st,token_str,token_ind);
     3484:  242:                get_actual_token(token_str,token_ind);
     3484:  243:                strcpy(token_ptr->token_string,token_str);
     3484:  244:                return(token_ptr);
     1903:  245:            case 30 :  /* This is COMMENT case */
     1903:  246:                fprintf(file_name,"P37,");
     1903:  247:                skip(tstream_ptr->ch_stream);
     1903:  248:                token_ind=next_st=0;
     1903:  249:                break;
        -:  250:        }
   117351:  251:        fprintf(file_name,"P38,");
   117351:  252:        cu_state=next_st;
   117351:  253:        ch=get_char(tstream_ptr->ch_stream);
        -:  254:    }
    #####:  255:}
        -:  256:
     2621:  257:static token numeric_case(tstream_ptr,token_ptr,ch,token_str,token_ind)
        -:  258:token_stream tstream_ptr;
        -:  259:token token_ptr;
        -:  260:char ch,token_str[];
        -:  261:int token_ind;
        -:  262:{
     2621:  263:    fprintf(file_name,"P39,");
     2621:  264:    if(check_delimiter(ch)!=TRUE)
        -:  265:    {   /* Error case */
      674:  266:        token_ptr->token_id=ERROR;
      674:  267:        fprintf(file_name,"P40,");
     2689:  268:        while(check_delimiter(ch)==FALSE)
        -:  269:        {
     2015:  270:            fprintf(file_name,"P41,");
     2015:  271:            if(token_ind >= 80)
        -:  272:            {
    #####:  273:                fprintf(file_name,"P42,");
    #####:  274:                break;
        -:  275:            }
     2015:  276:            fprintf(file_name,"P43,");  
     2015:  277:            token_str[token_ind++]=ch=get_char(tstream_ptr->ch_stream);
        -:  278:        }
      674:  279:        fprintf(file_name,"P44,");
      674:  280:        unget_char(ch,tstream_ptr->ch_stream);
      674:  281:        token_ind--;
      674:  282:        get_actual_token(token_str,token_ind);
      674:  283:        strcpy(token_ptr->token_string,token_str);
      674:  284:        return(token_ptr);
        -:  285:    }
     1947:  286:    fprintf(file_name,"P45,");
     1947:  287:    token_ptr->token_id=NUMERIC; /* Numeric case */
     1947:  288:    unget_char(ch,tstream_ptr->ch_stream);
     1947:  289:    token_ind--;
     1947:  290:    get_actual_token(token_str,token_ind);
     1947:  291:    strcpy(token_ptr->token_string,token_str);
     1947:  292:    return(token_ptr);
        -:  293:}
        -:  294:
    12173:  295:static token error_or_eof_case(tstream_ptr,token_ptr,cu_state,token_str,token_ind,ch)
        -:  296:token_stream tstream_ptr;
        -:  297:token token_ptr;
        -:  298:int cu_state,token_ind;
        -:  299:char token_str[],ch;
        -:  300:{
    12173:  301:    fprintf(file_name,"P46,");
    12173:  302:    if(is_end_of_character_stream(tstream_ptr->ch_stream)) 
        -:  303:    {
     4070:  304:        fprintf(file_name,"P47,");
     4070:  305:        token_ptr->token_id = EOTSTREAM;
     4070:  306:        token_ptr->token_string[0]='\0';
     4070:  307:        return(token_ptr);
        -:  308:    }
     8103:  309:    fprintf(file_name,"P48,");
     8103:  310:    if(cu_state !=0)
        -:  311:    {
     1216:  312:        fprintf(file_name,"P49,");
     1216:  313:        unget_char(ch,tstream_ptr->ch_stream);
     1216:  314:        token_ind--;
        -:  315:    }
     8103:  316:    fprintf(file_name,"P50,");
     8103:  317:    token_ptr->token_id=ERROR;
     8103:  318:    get_actual_token(token_str,token_ind);
     8103:  319:    strcpy(token_ptr->token_string,token_str);
     8103:  320:    return(token_ptr);                
        -:  321:}
        -:  322:
     7520:  323:static int check_delimiter(ch)
        -:  324:char ch;
        -:  325:{
     7520:  326:    fprintf(file_name,"P51,");
     7520:  327:    if(!isalpha(ch) && !isdigit(ch))
        -:  328:    {
     4787:  329:        fprintf(file_name,"P52,");
     4787:  330:        return(TRUE);
        -:  331:    }
     2733:  332:    fprintf(file_name,"P53,");
     2733:  333:    return(FALSE);
        -:  334:}
        -:  335:
     2166:  336:static int keyword(state)
        -:  337:int state;
        -:  338:{
     2166:  339:    fprintf(file_name,"P54,"); 
     2166:  340:    switch(state)
        -:  341:    {   /* Return the respective macro for the Keyword. */
      449:  342:        case 6 : 
      449:  343:            fprintf(file_name,"P55,"); 
      449:  344:            return(LAMBDA);
      445:  345:        case 9 : 
      445:  346:            fprintf(file_name,"P56,"); 
      445:  347:            return(AND);
      427:  348:        case 11:   
      427:  349:            fprintf(file_name,"P57,"); 
      427:  350:            return(OR);
      402:  351:        case 13: 
      402:  352:            fprintf(file_name,"P58,"); 
      402:  353:            return(IF);
      443:  354:        case 16:   
      443:  355:            fprintf(file_name,"P59,"); 
      443:  356:            return(XOR);
    #####:  357:        default: 
    #####:  358:            fprintf(file_name,"P60,"); 
    #####:  359:            fprintf(stdout, "error\n");break;
        -:  360:    }
    #####:  361:    fprintf(file_name,"P61,");
    #####:  362:    fclose(file_name);
    #####:  363:    exit(0);
        -:  364:}
        -:  365:
     5217:  366:static int special(state)
        -:  367:int state;
        -:  368:{
     5217:  369:    fprintf(file_name,"P62,"); 
     5217:  370:    switch(state)
        -:  371:    {   /* return the respective macro for the special character. */
      629:  372:        case 19: 
      629:  373:            fprintf(file_name,"P63,"); 
      629:  374:            return(LPAREN);
      685:  375:        case 20: 
      685:  376:            fprintf(file_name,"P64,"); 
      685:  377:            return(RPAREN);
      693:  378:        case 21: 
      693:  379:            fprintf(file_name,"P65,"); 
      693:  380:            return(LSQUARE);
      694:  381:        case 22: 
      694:  382:            fprintf(file_name,"P66,"); 
      694:  383:            return(RSQUARE);
      674:  384:        case 23: 
      674:  385:            fprintf(file_name,"P67,"); 
      674:  386:            return(QUOTE);
      685:  387:        case 24: 
      685:  388:            fprintf(file_name,"P68,"); 
      685:  389:            return(BQUOTE);
      654:  390:        case 25: 
      654:  391:            fprintf(file_name,"P69,"); 
      654:  392:            return(COMMA);
      503:  393:        case 32: 
      503:  394:            fprintf(file_name,"P70,"); 
      503:  395:            return(EQUALGREATER);
    #####:  396:        default: 
    #####:  397:            fprintf(file_name,"P71,");
    #####:  398:            fprintf(stdout, "error\n");break;
        -:  399:    }
    #####:  400:    fprintf(file_name,"P72,");
    #####:  401:    fclose(file_name);
    #####:  402:    exit(0);
        -:  403:}
        -:  404:
     1903:  405:static skip(stream_ptr)
        -:  406:character_stream stream_ptr;
        -:  407:{
        -:  408:    char c;
     1903:  409:    fprintf(file_name,"P73,"); 
    19824:  410:    while((c=get_char(stream_ptr))!='\n' && !is_end_of_character_stream(stream_ptr));
        -:  411:
     1903:  412:    fprintf(file_name,"P74,"); 
     1903:  413:	if(c==EOF)
        -:  414:    {
       42:  415:        fprintf(file_name,"P75,");
       42:  416:        unget_char(c, stream_ptr); /* Put back to leave gracefully - hf */
        -:  417:    }
     1903:  418:    fprintf(file_name,"P76,");
     1903:  419:    return;
        -:  420:}
        -:  421:
     3484:  422:static int constant(state,token_str,token_ind)
        -:  423:int state,token_ind;
        -:  424:char token_str[];
        -:  425:{
     3484:  426:    fprintf(file_name,"P77,"); 
     3484:  427:    switch(state)
        -:  428:    {   /* Return the respective CONSTANT macro. */
     1564:  429:        case 27 : 
     1564:  430:            fprintf(file_name,"P78,"); 
     1564:  431:            return(STRING_CONSTANT);
     1920:  432:        case 29 : 
     1920:  433:            fprintf(file_name,"P79,"); 
     1920:  434:            token_str[token_ind-2]=' '; 
     1920:  435:            return(CHARACTER_CONSTANT);
    #####:  436:        default : 
    #####:  437:            fprintf(file_name,"P80,");
    #####:  438:            break;
        -:  439:    }
    #####:  440:}
        -:  441:              
   240356:  442:static int next_state(state,ch)
        -:  443:int state;
        -:  444:char ch;
        -:  445:{
   240356:  446:    fprintf(file_name,"P81,"); 
   240356:  447:    if(state < 0)
        -:  448:    {
    23699:  449:        fprintf(file_name,"P82,");
    23699:  450:        return(state);
        -:  451:    }
        -:  452:    
   216657:  453:    fprintf(file_name,"P83,"); 
   216657:  454:    if(base[state]+ch >= 0)
        -:  455:    {
   205832:  456:        fprintf(file_name,"P84,"); 
   205832:  457:        if(check[base[state]+ch] == state) /* Check for the right state */
        -:  458:        {
   128218:  459:            fprintf(file_name,"P85,");
   128218:  460:            return(next[base[state]+ch]);
        -:  461:        }   
        -:  462:        else
        -:  463:        {
    77614:  464:            fprintf(file_name,"P86,");
    77614:  465:            return(next_state(default1[state],ch));
        -:  466:        }
        -:  467:    }
        -:  468:    else
        -:  469:    {
    10825:  470:        fprintf(file_name,"P87,");
    10825:  471:        return(next_state(default1[state],ch));
        -:  472:    }
        -:  473:}
        -:  474:
    34603:  475:BOOLEAN is_eof_token(t)
        -:  476:token t;
        -:  477:{
    34603:  478:    fprintf(file_name,"P88,"); 
    34603:  479:    if(t->token_id==EOTSTREAM)
        -:  480:    {
     4070:  481:        fprintf(file_name,"P89,");
     4070:  482:        return(TRUE);
        -:  483:    }
    30533:  484:    fprintf(file_name,"P90,");    
    30533:  485:    return(FALSE);
        -:  486:}
        -:  487:
    34603:  488:BOOLEAN print_token(token_ptr)
        -:  489:token token_ptr;
        -:  490:{
    34603:  491:    fprintf(file_name,"P91,"); 
    34603:  492:    switch(token_ptr->token_id)
        -:  493:    {    /* Print the respective tokens. */
     8777:  494:        case ERROR : 
     8777:  495:            fprintf(file_name,"P92,"); 
     8777:  496:            fprintf(stdout, "error,\t\"");
     8777:  497:            fprintf(stdout, "%s",token_ptr->token_string);
     8777:  498:            fprintf(stdout, "\".\n");
     8777:  499:            return(TRUE);
        -:  500:
     4070:  501:        case EOTSTREAM : 
     4070:  502:            fprintf(file_name,"P93,"); 
     4070:  503:            fprintf(stdout, "eof.\n");
     4070:  504:            return(TRUE);
        -:  505:
      449:  506:        case 6 : 
      449:  507:            fprintf(file_name,"P94,"); 
      449:  508:            fprintf(stdout, "keyword,\t\"lambda\".\n");
      449:  509:            return(TRUE);
        -:  510:
      445:  511:        case 9 : 
      445:  512:            fprintf(file_name,"P95,"); 
      445:  513:            fprintf(stdout, "keyword,\t\"and\".\n");
      445:  514:            return(TRUE);
        -:  515:
      427:  516:        case 11: 
      427:  517:            fprintf(file_name,"P96,"); 
      427:  518:            fprintf(stdout, "keyword,\t\"or\".\n");
      427:  519:            return(TRUE);
        -:  520:
      402:  521:        case 13: 
      402:  522:            fprintf(file_name,"P97,"); 
      402:  523:            fprintf(stdout, "keyword,\t\"if\".\n");
      402:  524:            return(TRUE);
        -:  525:
      443:  526:        case 16: 
      443:  527:            fprintf(file_name,"P98,"); 
      443:  528:            fprintf(stdout, "keyword,\t\"xor\".\n");
      443:  529:            return(TRUE);
        -:  530:
     8942:  531:        case 17: 
     8942:  532:            fprintf(file_name,"P99,"); 
     8942:  533:            fprintf(stdout, "identifier,\t\"");
     8942:  534:            fprintf(stdout, "%s",token_ptr->token_string);
     8942:  535:            fprintf(stdout, "\".\n");
     8942:  536:            return(TRUE);
        -:  537:
     1947:  538:        case 18: 
     1947:  539:            fprintf(file_name,"P100,"); 
     1947:  540:            fprintf(stdout, "numeric,\t");
     1947:  541:            fprintf(stdout, "%s",token_ptr->token_string);
     1947:  542:            fprintf(stdout, ".\n");
     1947:  543:            return(TRUE);
        -:  544:
      629:  545:        case 19: 
      629:  546:            fprintf(file_name,"P101,"); 
      629:  547:            fprintf(stdout, "lparen.\n");
      629:  548:            return(TRUE);
        -:  549:
      685:  550:        case 20: 
      685:  551:            fprintf(file_name,"P102,"); 
      685:  552:            fprintf(stdout, "rparen.\n");
      685:  553:            return(TRUE);
        -:  554:
      693:  555:        case 21: 
      693:  556:            fprintf(file_name,"P103,"); 
      693:  557:            fprintf(stdout, "lsquare.\n");
      693:  558:            return(TRUE);
        -:  559:
      694:  560:        case 22: 
      694:  561:            fprintf(file_name,"P104,"); 
      694:  562:            fprintf(stdout, "rsquare.\n");
      694:  563:            return(TRUE);
        -:  564:
      674:  565:        case 23: 
      674:  566:            fprintf(file_name,"P105,"); 
      674:  567:            fprintf(stdout, "quote.\n");
      674:  568:            return(TRUE);
        -:  569:
      685:  570:        case 24: 
      685:  571:            fprintf(file_name,"P106,"); 
      685:  572:            fprintf(stdout, "bquote.\n");
      685:  573:            return(TRUE);
        -:  574:
      654:  575:        case 25: 
      654:  576:            fprintf(file_name,"P107,"); 
      654:  577:            fprintf(stdout, "comma.\n");
      654:  578:            return(TRUE);
        -:  579:
     1564:  580:        case 27: 
     1564:  581:            fprintf(file_name,"P108,"); 
     1564:  582:            fprintf(stdout, "string,\t");
     1564:  583:            fprintf(stdout, "%s",token_ptr->token_string);
     1564:  584:            fprintf(stdout, ".\n");
     1564:  585:            return(TRUE);
        -:  586:
     1920:  587:        case 29: 
     1920:  588:            fprintf(file_name,"P109,"); 
     1920:  589:            fprintf(stdout, "character,\t\"");
     1920:  590:            fprintf(stdout, "%s",token_ptr->token_string);
     1920:  591:            fprintf(stdout, "\".\n");
     1920:  592:            return(TRUE);
        -:  593:
      503:  594:        case 32: 
      503:  595:            fprintf(file_name,"P110,"); 
      503:  596:            fprintf(stdout, "keyword,\t\"=>\".\n");
      503:  597:            return(TRUE);
        -:  598:
    #####:  599:        default: 
    #####:  600:            fprintf(file_name,"P111,");
    #####:  601:            break;
        -:  602:    }
    #####:  603:    fprintf(file_name,"P112,");
    #####:  604:    return(FALSE);
        -:  605:}
        -:  606:
    23150:  607:static get_actual_token(token_str,token_ind)
        -:  608:int token_ind;
        -:  609:char token_str[];
        -:  610:{
        -:  611:    int ind,start;
    23150:  612:    fprintf(file_name,"P113,");
    25690:  613:    for(ind=token_ind;ind>0 && isspace(token_str[ind-1]);--ind);
    23150:  614:    fprintf(file_name,"P114,");
    23150:  615:    token_str[ind]='\0';token_ind=ind;
    23150:  616:    fprintf(file_name,"P115,");
    37936:  617:    for(ind=0;ind<token_ind;++ind)
        -:  618:    {
    37882:  619:        fprintf(file_name,"P116,");
    37882:  620:        if(!isspace(token_str[ind]))
        -:  621:        {
    23096:  622:            fprintf(file_name,"P117,");
    23096:  623:            break;
        -:  624:        }
        -:  625:    }
        -:  626:        
    23150:  627:    fprintf(file_name,"P118,");   
   126033:  628:    for(start=0;ind<=token_ind;++start,++ind)
        -:  629:    {
   102883:  630:        fprintf(file_name,"P119,");
   102883:  631:        token_str[start]=token_str[ind];
        -:  632:    }
    23150:  633:    fprintf(file_name,"P120,");
    23150:  634:    return;
        -:  635:}
